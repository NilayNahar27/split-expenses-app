<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Split App</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    body { font-family: sans-serif; padding: 2rem; background-color: #f4f4f4; }
    h1 { color: #333; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    form { margin-bottom: 2rem; background: #fff; padding: 20px; border-radius: 8px; }
    input, select { margin-bottom: 10px; padding: 6px; width: 100%; }
    .settlement { margin-top: 20px; background: #e7f7e7; padding: 15px; border-radius: 6px; }
    .btn { padding: 6px 12px; border: none; cursor: pointer; border-radius: 4px; }
    .btn-danger { background-color: #e74c3c; color: white; }
    .btn-submit { background-color: #2ecc71; color: white; }
  </style>
</head>
<body>

  <h1>ðŸ’¸ Split Expense Tracker</h1>

  <form method="POST" action="/add-expense">
    <h2>Add New Expense</h2>
    <input type="text" name="description" placeholder="Description" required>
    <input type="number" name="amount" step="0.01" placeholder="Amount" required>
    <select name="paid_by" required>
      <option value="">Paid By</option>
      <% people.forEach(p => { %>
        <option value="<%= p %>"><%= p %></option>
      <% }) %>
    </select>

    <label>Participants:</label>
    <% people.forEach(p => { %>
      <label><input type="checkbox" name="participants" value="<%= p %>"> <%= p %></label>
    <% }) %>

    <br><br>
    <label><input type="checkbox" name="split_equally"> Split Equally</label>

    <h4>If not equal, enter custom shares:</h4>
    <% for(let i=0; i<people.length; i++) { %>
      <input type="text" name="custom_shares_names" placeholder="Name">
      <input type="number" name="custom_shares_amounts" step="0.01" placeholder="Amount">
    <% } %>

    <button type="submit" class="btn btn-submit">Add Expense</button>
  </form>

  <h2>Expenses</h2>
  <table>
    <thead>
      <tr>
        <th>Description</th>
        <th>Amount</th>
        <th>Paid By</th>
        <th>Participants</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <% expenses.forEach(exp => { %>
        <tr>
          <td><%= exp.description %></td>
          <td>â‚¹<%= exp.amount.toFixed(2) %></td>
          <td><%= exp.paid_by %></td>
          <td><%= exp.participants.join(', ') %></td>
          <td>
            <form method="POST" action="/expenses/<%= exp._id %>?_method=DELETE">
              <button type="submit" class="btn btn-danger">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <h2>People</h2>
  <ul>
    <% people.forEach(p => { %>
      <li><%= p %></li>
    <% }) %>
  </ul>

  <h2>Balances</h2>
  <ul>
    <% Object.entries(balances).forEach(([person, amount]) => { %>
      <li><%= person %>: â‚¹<%= amount.toFixed(2) %></li>
    <% }) %>
  </ul>

  <h2>Settlements</h2>
  <% if (settlements.length === 0) { %>
    <p class="settlement">âœ… All settled up!</p>
  <% } else { %>
    <ul class="settlement">
      <% settlements.forEach(s => { %>
        <li><%= s.from %> pays <%= s.to %> â‚¹<%= s.amount.toFixed(2) %></li>
      <% }) %>
    </ul>
  <% } %>

</body>
</html>
